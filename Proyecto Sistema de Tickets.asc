Proyecto Sistema de Tickets v1.2
================================
:doctype: book
:docinfo:
:lang: es
:toc: left
:toc-title: Índice de Contenido
:toclevels: 4
:pagenums:
:chapter-label: Capítulo
:icons: font
:imagesdir: imagenes
:sectnums:
:sectnumlevels: 4
:leveloffset: 1
:source-highlighter: highlightjs
:source-linenums-option: enable


= icon:code[] Envío de Tickets por medio de API hacia Redmine

== icon:ticket[] Redmine

image::https://www.redmine.org/attachments/download/3458/redmine_logo_v1.png[align="center"]

=== icon:info[] Descripción

*Redmine* es una herramienta web flexible, gratuita y de código abierto para la gestión de proyectos
que centraliza la comunicación y la información, permitiendo gestionar múltiples proyectos a la vez
con seguimientos de incidencias (bugs, tareas, requisitos), calendarios, diagramas de Gantt, wikis, 
foros, control de tiempo, y control de acceso basado en roles, integrándose además con sistemas de 
control de versiones. 

=== icon:copyright[] Licencia

Usa GNU GPL v2 es una licencia de software libre y de tipo "copyleft" que garantiza a los usuarios la libertad de ejecutar, estudiar, compartir y modificar el software, pero exige que cualquier obra derivada se distribuya bajo los mismos términos, haciendo que el código fuente sea público y no se pueda privatizar fácilmente, siendo muy usada por proyectos como el kernel de Linux y WordPress. 

=== icon:gear[] Desarrollo

==== icon:server[] BACKEND

===== icon:download[] Instalación

===== 1. Instalar Dependencias del Sistema
====== icon:picture-o[] Captura de pantalla

- Evidencia
+
image::actualizar_sistema.png[align="center",width=1000]
+
image::actualizar_dependencias.png[align="center",width=1000]

====== icon:terminal[] Instrucciones

[source,bash]
----
sudo apt update && sudo apt upgrade -y

sudo apt install -y \
    build-essential \
    ruby-full \
    ruby-dev \
    postgresql \
    postgresql-contrib \
    libpq-dev \
    libyaml-dev \
    zlib1g-dev \
    libssl-dev \
    libffi-dev \
    libreadline-dev \
    imagemagick \
    libmagickwand-dev \
    git \
    curl \
    wget
----

===== 2. Verificar Versiones
====== icon:picture-o[] Captura de pantalla

- Evidencia
+
image::verificar_versiones.png[align="center",width=1000]

====== icon:terminal[] Instrucciones

[source,bash]
----

cat /etc/debian_version

ruby -v

psql --version
----

===== 3. Descargar Redmine
====== icon:picture-o[] Captura de pantalla

- Evidencia
+
image::instalacion_redmine.png[align="center",width=1000]
+
image::instalacion_redmine2.png[align="center",width=1000]

====== icon:terminal[] Instrucciones

[source,bash]
----

cd /tmp

wget https://www.redmine.org/releases/redmine-6.1.0.tar.gz

tar -xzf redmine-6.1.0.tar.gz

sudo mv redmine-6.1.0 /opt/redmine

sudo chown -R $USER:$USER /opt/redmine

ls -la /opt/redmine
----

===== 4. Crear Base de Datos PostgreSQL
====== icon:picture-o[] Captura de pantalla

- Evidencia
+
image::crear_db_postgre.png[align="center",width=1000]

====== icon:terminal[] Instrucciones

[source,bash]
----
sudo -u postgres psql
----

[source,sql]
----
CREATE ROLE redmine LOGIN ENCRYPTED PASSWORD 'manzana10' NOINHERIT VALID UNTIL 'infinity';
CREATE DATABASE redmine WITH ENCODING='UTF8' OWNER=redmine;
\l
\q
----

===== icon:wrench[] Configuración

===== 5. Configurar database.yml
====== 5.1 Copiar archivo de configuración

====== icon:terminal[] Instrucciones

[source,bash]
----
cd /opt/redmine
cp config/database.yml.example config/database.yml
nano config/database.yml
----

====== 5.2 Editar database.yml
====== icon:picture-o[] Captura de pantalla

- Evidencia
+
image::editar_db.png[align="center",width=1000]

====== icon:terminal[] Instrucciones

[source,yaml]
----
production:
  adapter: postgresql
  database: redmine
  host: localhost
  username: redmine
  password: "manzana10"
  encoding: utf8
----

===== 6. Instalar Bundler
====== icon:picture-o[] Captura de pantalla

- Evidencia
+
image::instalar_bundler.png[align="center",width=1000]

====== icon:terminal[] Instrucciones

[source,bash]
----
sudo gem install bundler

bundler -v
----

===== 7. Instalar Dependencias de Redmine
====== icon:picture-o[] Captura de pantalla

- Evidencia
+
image::instalar_dependencias_redmine.png[align="center",width=1000]

====== icon:terminal[] Instrucciones

[source,bash]
----
cd /opt/redmine

bundle config set --local path 'vendor/bundle'

bundle install
----

===== 8. Generar Token Secreto
====== icon:terminal[] Instrucciones

[source,bash]
----
cd /opt/redmine
bundle exec rake generate_secret_token
----

===== 9. Crear Estructura de Base de Datos
====== icon:picture-o[] Captura de pantalla

- Evidencia
+
image::crear_estructura_db.png[align="center",width=1000]

====== icon:terminal[] Instrucciones

[source,bash]
----
cd /opt/redmine
RAILS_ENV=production bundle exec rake db:migrate
----

===== 10. Cargar Datos Iniciales en Español
====== icon:picture-o[] Captura de pantalla

- Evidencia
+
image::cargar_datos_iniciales.png[align="center",width=1000]

====== icon:terminal[] Instrucciones

[source,bash]
----
cd /opt/redmine
RAILS_ENV=production REDMINE_LANG=es bundle exec rake redmine:load_default_data
----

===== 11. Configurar Permisos
====== icon:picture-o[] Captura de pantalla

- Evidencia
+
image::permisos_necesarios.png[align="center",width=1000]

====== icon:terminal[] Instrucciones

[source,bash]
----
cd /opt/redmine

mkdir -p tmp tmp/pdf public/assets

sudo chown -R $USER:$USER files log tmp public/assets
sudo chmod -R 755 files log tmp public/assets

ls -la | grep -E 'files|log|tmp|public'
----

===== icon:terminal[] Ejecución

===== 12. Probar Redmine
====== icon:picture-o[] Captura de pantalla

- Evidencia
+
image::ejecutar_redmine.png[align="center",width=1000]
+
image::redmine_funcionando.png[align="center",width=1000]

====== icon:terminal[] Instrucciones

[source,bash]
----
cd /opt/redmine
bundle exec rails server -e production
----

Acceder a: http://localhost:3000

- *Usuario:* admin
- *Contraseña:* admin

===== icon:check[] Verificación
====== icon:picture-o[] Captura de pantalla

- Evidencia
+
image::redmine_funcionando2.png[align="center",width=1000]

==== icon:plug[] API

image::https://assets.goodfirms.co/glossary/1655457664-api.png[align="center"]

===== icon:info[] Descripción

*API* (Interfaz de Programación de Aplicaciones) es un puente de comunicación entre diferentes programas o sistemas, que les permite intercambiar datos o funcionalidades de forma controlada y estandarizada.

Redmine proporciona una API REST que permite crear, leer, actualizar y eliminar peticiones, proyectos, usuarios y otros recursos de forma programática mediante solicitudes HTTP. Para ello, se utilizará una extensión de Visual Studio Code llamada *REST Client*.

===== icon:wrench[] Configuración previa

====== 1. Activar servicio REST en Redmine
====== icon:picture-o[] Captura de pantalla

- Administration → Settings → API → Enable REST web service
+
image::api_activar_REST.png[align="center",width=1000]

====== 2. Configurar Port Forwarding en VirtualBox
====== icon:picture-o[] Captura de pantalla

- Configuración de red para acceder desde Windows a la VM
+
image::api_port_forwarding.png[align="center",width=1000]

====== 3. Obtener API Key
====== icon:picture-o[] Captura de pantalla

- My account → API access key → Show
+
image::api_get_api_key.png[align="center",width=1000]

===== icon:cube[] Herramientas

- icon:plug[] https://marketplace.visualstudio.com/items?itemName=humao.rest-client[REST Client - Extensión de Visual Studio Code]

===== icon:list[] Listado antes de la prueba de envío

====== icon:code[] Código

- icon:gear[] list.http
+
[source,html]
----
include::fuente/list.http[]
----

====== icon:picture-o[] Captura de pantalla

- Resultado del GET (lista de peticiones antes de crear una nueva)
+
image::api_get_1.png[align="center",width=1000]
+
image::api_get_2.png[align="center",width=1000]

===== icon:send[] Prueba de envío

====== icon:code[] Código

- icon:gear[] send.http
+
[source,html]
----
include::fuente/send.http[]
----

====== icon:picture-o[] Captura de pantalla

- Resultado del POST (creación de nueva petición)
+
image::api_post_1.png[align="center",width=1000]
+
image::api_post_2.png[align="center",width=1000]
+
image::api_post_3.png[align="center",width=1000]

===== icon:list[] Listado después de la prueba de envío

====== icon:picture-o[] Captura de pantalla

- Resultado del GET (ahora aparece la nueva petición creada)
+
image::api_get_after_post_1.png[align="center",width=1000]
+
image::api_get_after_post_2.png[align="center",width=1000]
+
image::api_get_after_post_3.png[align="center",width=1000]

==== icon:code[] FRONTEND

===== icon:info[] Descripción

El frontend es una aplicación web simple que permite crear tickets en Redmine a través de un formulario. Está desarrollado con HTML, CSS y JavaScript vanilla, utilizando Node.js como servidor proxy para evitar problemas de CORS.

===== icon:download[] Instalación

===== 1. Verificar Node.js instalado
====== icon:terminal[] Instrucciones

[source,bash]
----
node -v
npm -v
----

===== 2. Instalar dependencias del proyecto
====== icon:terminal[] Instrucciones

[source,bash]
----
cd fuente
npm install
----

===== icon:wrench[] Configuración

===== 3. Configurar credenciales de API
====== icon:terminal[] Instrucciones

Editar el archivo `script.js` y configurar las siguientes variables:

[source,javascript]
----
const REDMINE_API_KEY = 'tu-api-key-aqui'; 
const PROJECT_IDENTIFIER = 'nombre-del-proyecto';
----

===== 4. Configurar URL de Redmine
====== icon:terminal[] Instrucciones

Editar el archivo `server.js` y configurar la URL de Redmine:

[source,javascript]
----
const REDMINE_URL = 'http://localhost:3000';
----

===== icon:terminal[] Ejecución

===== 5. Iniciar servidor
====== icon:terminal[] Instrucciones

[source,bash]
----
cd fuente
node server.js
----

O usando npm:

[source,bash]
----
cd fuente
npm start
----

Acceder a: http://localhost:8080

===== icon:send[] Prueba de envío

====== icon:picture-o[] Captura de pantalla

- icon:gear[] App
+
image::app_test_01.png[align="center",width=1000]

===== icon:list[] Verificación de envío

====== icon:picture-o[] Captura de pantalla

- icon:ticket[] https://npr3s.com/control/projects/gti-0868-0498/issues[Peticiones en Proyecto gti-0868-0498 de Redmine]
+
image::app_test_02.png[align="center",width=1000]

===== icon:code[] Código del App

- fuente/index.html
+
[source,html]
----
include::fuente/index.html[]
----

- fuente/style.css
+
[source,css]
----
include::fuente/style.css[]
----

- fuente/script.js
+
[source,javascript]
----
include::fuente/script.js[]
----

- fuente/server.js
+
[source,javascript]
----
include::fuente/server.js[]
----


=== icon:gear[] Gestión

==== icon:book[] Proyecto 1/2

===== icon:plus[] Creación
====== icon:picture-o[] Captura de pantalla

- Creación de nuevo proyecto en Redmine
+
image::gestion_creacion_proyecto.png[align="center",width=1000]

==== icon:ticket[] Peticiones

===== icon:eye[] Ver
====== icon:picture-o[] Captura de pantalla

- Lista de peticiones del proyecto
+
image::gestion_ver_peticiones.png[align="center",width=1000]

===== icon:edit[] Modificar
====== icon:picture-o[] Captura de pantalla

- Editando una petición existente
+
image::gestion_modificar_peticion.png[align="center",width=1000]

===== icon:star[] Priorizar
====== icon:picture-o[] Captura de pantalla

- Cambiando la prioridad de una petición
+
image::gestion_priorizar_peticion.png[align="center",width=1000]

===== icon:wrench[] Trabajo
====== icon:picture-o[] Captura de pantalla

- Cambiando el estado de una petición (New → In Progress → Resolved)
+
image::gestion_trabajo_peticion.png[align="center",width=1000]

===== icon:trash[] Eliminar
====== icon:picture-o[] Captura de pantalla

- Eliminando una petición
+
image::gestion_eliminar_peticion.png[align="center",width=1000]

==== icon:book[] Proyecto 2/2

===== icon:edit[] Modificar
====== icon:picture-o[] Captura de pantalla

- Editando configuración del proyecto
+
image::gestion_modificar_proyecto.png[align="center",width=1000]

===== icon:trash[] Eliminar
====== icon:picture-o[] Captura de pantalla

- Eliminando el proyecto
+
image::gestion_eliminar_proyecto_1.png[align="center",width=1000]
+
image::gestion_eliminar_proyecto_2.png[align="center",width=1000]

== icon:users[] Autores

[%header,cols=">,<"]
|===

|Cuenta
|Nombre

|icon:hashtag[] 12241104
|icon:user[] Daniel Reyes

|icon:hashtag[] 12111345
|icon:user[] Alberth Godoy

|icon:hashtag[] 12041196
|icon:user[] Karin Martinez

|===

== icon:book[] Referencias

- icon:link[] https://www.redmine.org/[Redmine - Project Management Web Application]
- icon:link[] https://docs.asciidoctor.org/[Asciidoctor Documentation Home]

[.text-center]
**Desarrollado** para *Gobernabilidad de Tecnologías de Información | UNITEC*